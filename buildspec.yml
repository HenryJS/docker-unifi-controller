version: 0.2


env:
  shell: bash

phases:
  pre_build:
    commands:
      - "docker login -u lumel -p $PASSWORD"
      - echo Branch is $BRANCH
      - "echo Branch is $BRANCH"
      - git symbolic-ref HEAD --short 2>/dev/null

  build:
    commands:
      - docker build -t lumel/unifi-controller:$BRANCH .

  post_build:
    commands:
      - docker push lumel/unifi-controller:$BRANCH


